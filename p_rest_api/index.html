<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=3YY1w6aTFW3k2gDPiQQHxzKkbvdsl2g7"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
    <title>热力图功能示例</title>
    <style type="text/css">
        ul,
        li {
            list-style: none;
            margin: 0;
            padding: 0;
            float: left;
        }

        html {
            height: 100%
        }

        body {
            height: 100%;
            margin: 0px;
            padding: 0px;
            font-family: "微软雅黑";
        }

        #container {
            height: 100%
        }

        #r-result {
            width: 100%
        }
    </style>
</head>

<body>
    <div id="container"></div>
    
</body>

</html>

<script type="text/javascript">
    var map = new BMap.Map("container"); // 创建地图实例 
    var point = new BMap.Point(106.55211, 29.558189); // 创建点坐标  ,重庆
    map.centerAndZoom(point, 6); // 设置中心点坐标和地图级别

    //地图事件设置函数：
    function setMapEvent() {
        map.disableDragging(); //禁用地图拖拽事件
        map.disableScrollWheelZoom(); //禁用地图滚轮放大缩小，默认禁用(可不写)
        map.disableDoubleClickZoom(); //禁用鼠标双击放大
        map.disableKeyboard(); //禁用键盘上下左右键移动地图，默认禁用(可不写)
    }

    //地图控件添加函数：
    function addMapControl() {}

    setMapEvent(); //设置地图事件
    addMapControl(); //向地图添加控件


    // topline  points data 

    var points = [{
        "lat": 39.92998577808024,
        "lng": 116.39564503787867,
        "count": 124.7
    }, {
        "lat": 39.143929903310074,
        "lng": 117.21081309155257,
        "count": 123.2
    }, {
        "lat": 31.24916171001514,
        "lng": 121.48789948569473,
        "count": 118.5
    }, ]



    // upline

    if (!isSupportCanvas()) {
        alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
    }

    heatmapOverlay = new BMapLib.HeatmapOverlay({
        "radius": 20
    });
    map.addOverlay(heatmapOverlay);
    heatmapOverlay.setDataSet({
        data: points,
        max: 200
    });
    //是否显示热力图
    function openHeatmap() {
        heatmapOverlay.show();
    }

    function closeHeatmap() {
        heatmapOverlay.hide();
    }
    openHeatmap();

    function setGradient() {
        var gradient = {};
        var colors = document.querySelectorAll("input[type='color']");
        colors = [].slice.call(colors, 0);
        colors.forEach(function (ele) {
            gradient[ele.getAttribute("data-key")] = ele.value;
        });
        heatmapOverlay.setOptions({
            "gradient": gradient
        });
    }
    //判断浏览区是否支持canvas
    function isSupportCanvas() {
        var elem = document.createElement('canvas');
        return !!(elem.getContext && elem.getContext('2d'));
    }
</script>